services:

  bootstrap-setup:
    image: touk/nussknacker-example-scenarios-library:0.3.0-SNAPSHOT # todo: bump
    depends_on:
      nginx:
        condition: service_healthy
      designer:
        condition: service_healthy
      kafka:
        condition: service_healthy
      schema-registry:
        condition: service_healthy
    environment:
      DISABLE_EMBEDDED_EXAMPLES: true
      BENCHMARK_FLINK_DEPLOY: false
      NU_DESIGNER_ADDRESS: "nginx:8080"
      NU_REQUEST_RESPONSE_OPEN_API_SERVICE_ADDRESS: "nginx:8181"
      KAFKA_ADDRESS: "kafka:9092"
      SCHEMA_REGISTRY_ADDRESS: "schema-registry:8081"
    volumes:
      - ../../benchmarks/src/test/resources/e2e/benchmark-flink:/scenario-examples/benchmark-flink
    deploy:
      resources:
        limits:
          memory: 256M
          cpus: '0.5'

  designer:
    environment:
      KAFKA_AUTO_OFFSET_RESET: "earliest"
