openapi: 3.1.0
info:
  title: Nussknacker Scenario Activity API
  version: 1.1.0
paths:
  /api/processes/{scenarioName}/activity:
    get:
      tags:
      - Activities
      summary: Scenario activity service
      operationId: getApiProcessesScenarionameActivity
      parameters:
      - name: scenarioName
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScenarioCommentsAndAttachments'
              examples:
                Example:
                  summary: Display scenario activity
                  value:
                    comments:
                    - id: 1
                      processVersionId: 1
                      content: some comment
                      user: test
                      createDate: '2024-01-17T14:21:17Z'
                    attachments:
                    - id: 1
                      processVersionId: 1
                      fileName: some_file.txt
                      user: test
                      createDate: '2024-01-17T14:21:17Z'
        '404':
          description: ''
          content:
            text/plain:
              schema:
                type: string
              examples:
                Example:
                  summary: No scenario {scenarioName} found
                  value: No scenario 'example scenario' found
      deprecated: true
  /api/processes/{scenarioName}/activity/activities/count:
    get:
      tags:
      - Activities
      summary: Scenario activities count service
      operationId: getApiProcessesScenarionameActivityActivitiesCount
      parameters:
      - name: scenarioName
        in: path
        required: true
        schema:
          type: string
      - name: activityType
        in: query
        required: false
        schema:
          type: array
          items:
            type: string
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScenarioActivitiesCount'
              example:
                fullCount: 123
        '400':
          description: 'Invalid value for: query parameter activityType'
          content:
            text/plain:
              schema:
                type: string
        '404':
          description: ''
          content:
            text/plain:
              schema:
                type: string
              examples:
                Example:
                  summary: No scenario {scenarioName} found
                  value: No scenario 'example scenario' found
  /api/processes/{scenarioName}/activity/activities/search:
    get:
      tags:
      - Activities
      summary: Scenario activities count service
      operationId: getApiProcessesScenarionameActivityActivitiesSearch
      parameters:
      - name: scenarioName
        in: path
        required: true
        schema:
          type: string
      - name: searchText
        in: query
        required: true
        schema:
          type: string
      - name: activityType
        in: query
        required: false
        schema:
          type: array
          items:
            type: string
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScenarioActivitiesSearchResult'
              examples:
                Example:
                  summary: Result of activities full-text search
                  value:
                    foundActivities:
                    - id: 2c0af07d-4eaa-422a-8d1a-84d299e74fe2
                      index: 101
                    - id: 7889376c-af8d-4dfa-9a72-83ca73f29946
                      index: 498
        '400':
          description: 'Invalid value for: query parameter searchText, Invalid value
            for: query parameter activityType'
          content:
            text/plain:
              schema:
                type: string
        '404':
          description: ''
          content:
            text/plain:
              schema:
                type: string
              examples:
                Example:
                  summary: No scenario {scenarioName} found
                  value: No scenario 'example scenario' found
  /api/processes/{scenarioName}/activity/activities/metadata:
    get:
      tags:
      - Activities
      summary: Scenario activities metadata service
      operationId: getApiProcessesScenarionameActivityActivitiesMetadata
      parameters:
      - name: scenarioName
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScenarioActivitiesMetadata'
              example:
                activities:
                - type: SCENARIO_CREATED
                  displayableName: Scenario created
                  icon: /assets/states/error.svg
                  supportedActions: []
                - type: SCENARIO_ARCHIVED
                  displayableName: Scenario archived
                  icon: /assets/states/error.svg
                  supportedActions: []
                - type: SCENARIO_UNARCHIVED
                  displayableName: Scenario unarchived
                  icon: /assets/states/error.svg
                  supportedActions: []
                - type: SCENARIO_DEPLOYED
                  displayableName: Deployment
                  icon: /assets/states/error.svg
                  supportedActions: []
                - type: SCENARIO_CANCELED
                  displayableName: Cancel
                  icon: /assets/states/error.svg
                  supportedActions: []
                - type: SCENARIO_MODIFIED
                  displayableName: New version saved
                  icon: /assets/states/error.svg
                  supportedActions:
                  - compare
                - type: SCENARIO_NAME_CHANGED
                  displayableName: Scenario name changed
                  icon: /assets/states/error.svg
                  supportedActions: []
                - type: COMMENT_ADDED
                  displayableName: Comment
                  icon: /assets/states/error.svg
                  supportedActions:
                  - delete_comment
                  - edit_comment
                - type: ATTACHMENT_ADDED
                  displayableName: Attachment
                  icon: /assets/states/error.svg
                  supportedActions: []
                - type: CHANGED_PROCESSING_MODE
                  displayableName: Processing mode change
                  icon: /assets/states/error.svg
                  supportedActions: []
                - type: INCOMING_MIGRATION
                  displayableName: Incoming migration
                  icon: /assets/states/error.svg
                  supportedActions:
                  - compare
                - type: OUTGOING_MIGRATION
                  displayableName: Outgoing migration
                  icon: /assets/states/error.svg
                  supportedActions: []
                - type: PERFORMED_SINGLE_EXECUTION
                  displayableName: Processing data
                  icon: /assets/states/error.svg
                  supportedActions: []
                - type: PERFORMED_SCHEDULED_EXECUTION
                  displayableName: Processing data
                  icon: /assets/states/error.svg
                  supportedActions: []
                - type: AUTOMATIC_UPDATE
                  displayableName: Automatic update
                  icon: /assets/states/error.svg
                  supportedActions:
                  - compare
                actions:
                - id: compare
                  displayableName: Compare
                  icon: /assets/states/error.svg
                - id: delete_comment
                  displayableName: Delete
                  icon: /assets/states/error.svg
                - id: edit_comment
                  displayableName: Edit
                  icon: /assets/states/error.svg
                - id: download_attachment
                  displayableName: Download
                  icon: /assets/states/error.svg
                - id: delete_attachment
                  displayableName: Delete
                  icon: /assets/states/error.svg
        '404':
          description: ''
          content:
            text/plain:
              schema:
                type: string
              examples:
                Example:
                  summary: No scenario {scenarioName} found
                  value: No scenario 'example scenario' found
  /api/processes/{scenarioName}/activity/activities:
    get:
      tags:
      - Activities
      summary: Scenario activities service
      operationId: getApiProcessesScenarionameActivityActivities
      parameters:
      - name: scenarioName
        in: path
        required: true
        schema:
          type: string
      - name: pageSize
        in: query
        required: true
        schema:
          type: integer
          format: int64
      - name: pageNumber
        in: query
        required: true
        schema:
          type: integer
          format: int64
      - name: activityType
        in: query
        required: false
        schema:
          type: array
          items:
            type: string
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScenarioActivities'
              examples:
                Example:
                  summary: Display scenario actions
                  value:
                    activities:
                    - id: 8252c5f8-1a66-492e-a502-d0e77b5ebead
                      type: SCENARIO_CREATED
                      user: some user
                      date: '2024-01-17T14:21:17Z'
                      processVersionId: 1
                      additionalFields: []
                    - id: bd37b413-c5c1-4531-bccf-2c7c9ef3c767
                      type: SCENARIO_ARCHIVED
                      user: some user
                      date: '2024-01-17T14:21:17Z'
                      processVersionId: 1
                      additionalFields: []
                    - id: dbac6264-fa76-49d4-8adc-383771c9391f
                      type: SCENARIO_UNARCHIVED
                      user: some user
                      date: '2024-01-17T14:21:17Z'
                      processVersionId: 1
                      additionalFields: []
                    - id: 97955662-253a-4b47-a3a1-a3c686e2ceeb
                      type: SCENARIO_DEPLOYED
                      user: some user
                      date: '2024-01-17T14:21:17Z'
                      processVersionId: 1
                      comment: Deployment of scenario - task JIRA-1234
                      additionalFields: []
                    - id: 03b56b73-cfa7-4944-9662-5c4e1b8f1226
                      type: SCENARIO_CANCELED
                      user: some user
                      date: '2024-01-17T14:21:17Z'
                      processVersionId: 1
                      comment: Canceled because marketing campaign ended
                      additionalFields: []
                    - id: 9157e61e-bb4c-44ac-b23b-05239e7cdbf4
                      type: SCENARIO_MODIFIED
                      user: some user
                      date: '2024-01-17T14:21:17Z'
                      processVersionId: 1
                      comment: Added new processing step
                      additionalFields: []
                      overrideDisplayableName: Version 1 saved
                    - id: 424d8abf-1b84-4fcb-b9f7-d9b93a603ecf
                      type: SCENARIO_NAME_CHANGED
                      user: some user
                      date: '2024-01-17T14:21:17Z'
                      processVersionId: 1
                      additionalFields:
                      - name: oldName
                        value: marketing campaign
                      - name: newName
                        value: old marketing campaign
                    - id: 75ee76d6-4ef8-4649-be1a-6688b730f218
                      type: COMMENT_ADDED
                      user: some user
                      date: '2024-01-17T14:21:17Z'
                      processVersionId: 1
                      comment: Now scenario handles errors in datasource better
                      additionalFields: []
                    - id: e25efda9-f5d3-470d-9d96-adc180a878ef
                      type: COMMENT_ADDED
                      user: some user
                      date: '2024-01-17T14:21:17Z'
                      processVersionId: 1
                      additionalFields:
                      - name: deletedByUser
                        value: John Doe
                      overrideSupportedActions: []
                    - id: ece0ceec-621d-4261-9b3d-54205c3e8ed4
                      type: ATTACHMENT_ADDED
                      user: some user
                      date: '2024-01-17T14:21:17Z'
                      processVersionId: 1
                      additionalFields:
                      - name: attachmentId
                        value: '10000001'
                      - name: attachmentFilename
                        value: attachment01.png
                    - id: 7136db97-cb7d-489b-be29-aa104ade7811
                      type: ATTACHMENT_ADDED
                      user: some user
                      date: '2024-01-17T14:21:17Z'
                      processVersionId: 1
                      additionalFields:
                      - name: deletedByUser
                        value: John Doe
                      overrideSupportedActions: []
                    - id: 03f1f6b8-40ef-4fea-9ebd-75ffe34b894e
                      type: CHANGED_PROCESSING_MODE
                      user: some user
                      date: '2024-01-17T14:21:17Z'
                      processVersionId: 1
                      additionalFields:
                      - name: from
                        value: Request-Response
                      - name: to
                        value: Request-Response
                    - id: 0e3aacb9-0353-41d1-a9ca-5c49fe97f145
                      type: INCOMING_MIGRATION
                      user: some user
                      date: '2024-01-17T14:21:17Z'
                      processVersionId: 1
                      comment: Migration from preprod
                      additionalFields:
                      - name: sourceEnvironment
                        value: preprod
                      - name: sourceProcessVersionId
                        value: '23'
                    - id: f0aba6b8-28c7-4575-8fc2-f46e53def821
                      type: OUTGOING_MIGRATION
                      user: some user
                      date: '2024-01-17T14:21:17Z'
                      processVersionId: 1
                      comment: Migration to preprod
                      additionalFields:
                      - name: destinationEnvironment
                        value: preprod
                    - id: c72d3bfb-6040-4225-9f61-95de4be206a2
                      type: PERFORMED_SINGLE_EXECUTION
                      user: some user
                      date: '2024-01-17T14:21:17Z'
                      processVersionId: 1
                      additionalFields:
                      - name: dateFinished
                        value: '2024-01-17T14:21:17Z'
                      - name: status
                        value: Successfully executed
                    - id: 2172c10a-dee5-4d80-9a1e-7730a9ec3bf0
                      type: PERFORMED_SCHEDULED_EXECUTION
                      user: some user
                      date: '2024-01-17T14:21:17Z'
                      processVersionId: 1
                      additionalFields:
                      - name: params
                        value: Batch size=1
                      - name: dateFinished
                        value: '2024-01-17T14:21:17Z'
                      - name: status
                        value: Successfully executed
                    - id: 76f65549-39ac-430d-9158-a51debf0479d
                      type: AUTOMATIC_UPDATE
                      user: some user
                      date: '2024-01-17T14:21:17Z'
                      processVersionId: 1
                      additionalFields:
                      - name: changes
                        value: JIRA-12345, JIRA-32146
                      - name: dateFinished
                        value: '2024-01-17T14:21:17Z'
                      - name: status
                        value: Successful
        '400':
          description: 'Invalid value for: query parameter pageSize, Invalid value
            for: query parameter pageNumber, Invalid value for: query parameter activityType'
          content:
            text/plain:
              schema:
                type: string
        '404':
          description: ''
          content:
            text/plain:
              schema:
                type: string
              examples:
                Example:
                  summary: No scenario {scenarioName} found
                  value: No scenario 'example scenario' found
  /api/processes/{scenarioName}/{versionId}/activity/comments:
    post:
      tags:
      - Comments
      summary: Add scenario comment service
      operationId: postApiProcessesScenarionameVersionidActivityComments
      parameters:
      - name: scenarioName
        in: path
        required: true
        schema:
          type: string
      - name: versionId
        in: path
        required: true
        schema:
          type: integer
          format: int64
      requestBody:
        content:
          text/plain:
            schema:
              type: string
        required: true
      responses:
        '200':
          description: ''
        '400':
          description: 'Invalid value for: path parameter versionId, Invalid value
            for: body'
          content:
            text/plain:
              schema:
                type: string
        '404':
          description: ''
          content:
            text/plain:
              schema:
                type: string
              examples:
                Example:
                  summary: No scenario {scenarioName} found
                  value: No scenario 'example scenario' found
  /api/processes/{scenarioName}/activity/comments/{commentId}:
    put:
      tags:
      - Comments
      summary: Edit process comment service
      operationId: putApiProcessesScenarionameActivityCommentsCommentid
      parameters:
      - name: scenarioName
        in: path
        required: true
        schema:
          type: string
      - name: commentId
        in: path
        required: true
        schema:
          type: integer
          format: int64
      requestBody:
        content:
          text/plain:
            schema:
              type: string
        required: true
      responses:
        '200':
          description: ''
        '400':
          description: 'Invalid value for: path parameter commentId, Invalid value
            for: body'
          content:
            text/plain:
              schema:
                type: string
        '404':
          description: ''
          content:
            text/plain:
              schema:
                type: string
              examples:
                Example:
                  summary: No scenario {scenarioName} found
                  value: No scenario 'example scenario' found
        '500':
          description: ''
          content:
            text/plain:
              schema:
                type: string
              examples:
                Example:
                  summary: 'Unable to edit comment with id: {commentId}'
                  value: 'Unable to delete comment with id: 1'
    delete:
      tags:
      - Comments
      summary: Delete process comment service
      operationId: deleteApiProcessesScenarionameActivityCommentsCommentid
      parameters:
      - name: scenarioName
        in: path
        required: true
        schema:
          type: string
      - name: commentId
        in: path
        required: true
        schema:
          type: integer
          format: int64
      responses:
        '200':
          description: ''
        '400':
          description: 'Invalid value for: path parameter commentId'
          content:
            text/plain:
              schema:
                type: string
        '404':
          description: ''
          content:
            text/plain:
              schema:
                type: string
              examples:
                Example:
                  summary: No scenario {scenarioName} found
                  value: No scenario 'example scenario' found
        '500':
          description: ''
          content:
            text/plain:
              schema:
                type: string
              examples:
                Example:
                  summary: 'Unable to edit comment with id: {commentId}'
                  value: 'Unable to delete comment with id: 1'
  /api/processes/{scenarioName}/activity/attachments:
    get:
      tags:
      - Attachments
      summary: Scenario attachments service
      operationId: getApiProcessesScenarionameActivityAttachments
      parameters:
      - name: scenarioName
        in: path
        required: true
        schema:
          type: string
      responses:
        '200':
          description: ''
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ScenarioAttachments'
              examples:
                Example:
                  summary: Display scenario activity
                  value:
                    attachments:
                    - id: 1
                      processVersionId: 1
                      fileName: some_file.txt
                      user: test
                      createDate: '2024-01-17T14:21:17Z'
        '404':
          description: ''
          content:
            text/plain:
              schema:
                type: string
              examples:
                Example:
                  summary: No scenario {scenarioName} found
                  value: No scenario 'example scenario' found
  /api/processes/{scenarioName}/{versionId}/activity/attachments:
    post:
      tags:
      - Attachments
      summary: Add scenario attachment service
      operationId: postApiProcessesScenarionameVersionidActivityAttachments
      parameters:
      - name: scenarioName
        in: path
        required: true
        schema:
          type: string
      - name: versionId
        in: path
        required: true
        schema:
          type: integer
          format: int64
      - name: Content-Disposition
        in: header
        required: true
        schema:
          type: string
      requestBody:
        content:
          application/octet-stream:
            schema:
              type: string
              format: binary
        required: true
      responses:
        '200':
          description: ''
        '400':
          description: 'Invalid value for: path parameter versionId, Invalid value
            for: body, Invalid value for: header Content-Disposition'
          content:
            text/plain:
              schema:
                type: string
        '404':
          description: ''
          content:
            text/plain:
              schema:
                type: string
              examples:
                Example:
                  summary: No scenario {scenarioName} found
                  value: No scenario 'example scenario' found
  /api/processes/{scenarioName}/activity/attachments/{attachmentId}:
    get:
      tags:
      - Attachments
      summary: Download attachment service
      operationId: getApiProcessesScenarionameActivityAttachmentsAttachmentid
      parameters:
      - name: scenarioName
        in: path
        required: true
        schema:
          type: string
      - name: attachmentId
        in: path
        required: true
        schema:
          type: integer
          format: int64
      responses:
        '200':
          description: ''
          headers:
            Content-Disposition:
              required: false
              schema:
                type:
                - string
                - 'null'
            Content-Type:
              required: true
              schema:
                type: string
          content:
            application/octet-stream:
              schema:
                type: string
                format: binary
        '400':
          description: 'Invalid value for: path parameter attachmentId'
          content:
            text/plain:
              schema:
                type: string
        '404':
          description: ''
          content:
            text/plain:
              schema:
                type: string
              examples:
                Example:
                  summary: No scenario {scenarioName} found
                  value: No scenario 'example scenario' found
components:
  schemas:
    AdditionalField:
      title: AdditionalField
      type: object
      required:
      - name
      - value
      properties:
        name:
          type: string
        value:
          type: string
    Attachment:
      title: Attachment
      type: object
      required:
      - id
      - processVersionId
      - fileName
      - user
      - createDate
      properties:
        id:
          type: integer
          format: int64
        processVersionId:
          type: integer
          format: int64
        fileName:
          type: string
        user:
          type: string
        createDate:
          type: string
          format: date-time
    Comment:
      title: Comment
      type: object
      required:
      - id
      - processVersionId
      - content
      - user
      - createDate
      properties:
        id:
          type: integer
          format: int64
        processVersionId:
          type: integer
          format: int64
        content:
          type: string
        user:
          type: string
        createDate:
          type: string
          format: date-time
    FoundActivity:
      title: FoundActivity
      type: object
      required:
      - id
      - index
      properties:
        id:
          type: string
        index:
          type: integer
          format: int32
    ScenarioActivities:
      title: ScenarioActivities
      type: object
      properties:
        activities:
          type: array
          items:
            $ref: '#/components/schemas/ScenarioActivity'
    ScenarioActivitiesCount:
      title: ScenarioActivitiesCount
      type: object
      required:
      - fullCount
      properties:
        fullCount:
          type: integer
          format: int64
    ScenarioActivitiesMetadata:
      title: ScenarioActivitiesMetadata
      type: object
      properties:
        activities:
          type: array
          items:
            $ref: '#/components/schemas/ScenarioActivityMetadata'
        actions:
          type: array
          items:
            $ref: '#/components/schemas/ScenarioActivityActionMetadata'
    ScenarioActivitiesSearchResult:
      title: ScenarioActivitiesSearchResult
      type: object
      properties:
        foundActivities:
          type: array
          items:
            $ref: '#/components/schemas/FoundActivity'
    ScenarioActivity:
      title: ScenarioActivity
      type: object
      required:
      - id
      - type
      - user
      - date
      - processVersionId
      properties:
        id:
          type: string
        type:
          type: string
          enum:
          - SCENARIO_CREATED
          - SCENARIO_ARCHIVED
          - SCENARIO_UNARCHIVED
          - SCENARIO_DEPLOYED
          - SCENARIO_CANCELED
          - SCENARIO_MODIFIED
          - SCENARIO_NAME_CHANGED
          - COMMENT_ADDED
          - ATTACHMENT_ADDED
          - CHANGED_PROCESSING_MODE
          - INCOMING_MIGRATION
          - OUTGOING_MIGRATION
          - PERFORMED_SINGLE_EXECUTION
          - PERFORMED_SCHEDULED_EXECUTION
          - AUTOMATIC_UPDATE
        user:
          type: string
        date:
          type: string
          format: date-time
        processVersionId:
          type: integer
          format: int64
        comment:
          type:
          - string
          - 'null'
        additionalFields:
          type: array
          items:
            $ref: '#/components/schemas/AdditionalField'
        overrideDisplayableName:
          type:
          - string
          - 'null'
        overrideSupportedActions:
          type:
          - array
          - 'null'
          items:
            type: string
    ScenarioActivityActionMetadata:
      title: ScenarioActivityActionMetadata
      type: object
      required:
      - id
      - displayableName
      - icon
      properties:
        id:
          type: string
        displayableName:
          type: string
        icon:
          type: string
    ScenarioActivityMetadata:
      title: ScenarioActivityMetadata
      type: object
      required:
      - type
      - displayableName
      - icon
      properties:
        type:
          type: string
        displayableName:
          type: string
        icon:
          type: string
        supportedActions:
          type: array
          items:
            type: string
    ScenarioAttachments:
      title: ScenarioAttachments
      type: object
      properties:
        attachments:
          type: array
          items:
            $ref: '#/components/schemas/Attachment'
    ScenarioCommentsAndAttachments:
      title: ScenarioCommentsAndAttachments
      type: object
      properties:
        comments:
          type: array
          items:
            $ref: '#/components/schemas/Comment'
        attachments:
          type: array
          items:
            $ref: '#/components/schemas/Attachment'
